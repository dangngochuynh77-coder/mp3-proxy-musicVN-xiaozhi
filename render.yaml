services:
  # Dịch vụ 1: API Nhạc (Backend) - Build bằng Node.js
  - type: web
    name: mp3-api
    env: node          # <-- THAY ĐỔI 1: Đổi 'docker' thành 'node'
    plan: free 
    autoDeploy: true
    # Báo Render lấy code từ thư mục 'mp3-api'
    rootDir: ./mp3-api 
    buildCommand: npm install  # <-- THAY ĐỔI 2: Thêm lệnh build
    startCommand: npm start    # <-- THAY ĐỔI 3: Thêm lệnh khởi động

  # Dịch vụ 2: Adapter cho Xiaozhi (Frontend/Proxy) - Build bằng Docker
  - type: web
    name: xiaozhi-adapter
    env: docker
    plan: free 
    dockerContext: ./adapter
    dockerfilePath: Dockerfile # Giữ nguyên như lần sửa trước
    autoDeploy: true
    envVars:
      - key: PORT
        value: 5005
      - key: MP3_API_URL
        # Link này vẫn đúng, Render sẽ tự link 2 dịch vụ
        # Service 'mp3-api' sẽ chạy trên port 5555 nội bộ
        value: http://mp3-api:5555
